---
title: DeepFM
tags:
- Paper
toc: true
toc_sticky: true
toc_label: contents
categories:
- Recommendation
---

# DeepFM
##### A Factorization-Machine based Neural Network
## 01. what is CTR ? 
#### CTR : click Through  rate 

CTR ì´ë€ ? 
* ì‚¬ìš©ìì˜ í´ë¦­ ì•ˆì— ìˆ¨ê²¨ì ¸ ìˆëŠ” ì‚¬ìš©ìì˜ íŠ¹ì„± ë˜ëŠ” ì–´í”Œì˜ íŠ¹ì„± ì‚¬ì´ì˜ ìƒê´€ê´€ê³„ í•™ìŠµ
* ì˜ˆ) ì‹ì‚¬ ì‹œê°„ ì— ìŒì‹ ë°°ë‹¬ ì–´í”Œì˜ ë‹¤ìš´ë¡œë“œ ìˆ˜ ì¦ê°€ ( 2 ì°¨ ìƒê´€ê´€ê³„)
    * 10ëŒ€ ë‚¨ìëŠ” ì´ ê²Œì„ ê³¼ RPG ê²Œì„ì„ ì„ í˜¸ ( 3 ì°¨ ìƒê´€ê´€ê³„ )
* ì‚¬ìš©ìì˜ í´ë¦­ ìŠµê´€ì€ ì €,ê³ ì°¨ì›ì˜ íŠ¹ì„± ìƒê´€ê´€ê³„ë¥¼ ê°€ì§€ê³  ìˆë‹¤. 
* íš¨ìœ¨ì ì¸ íŠ¹ì„±ìƒê´€ê´€ê³„ ëª¨ë¸ë§ ë°©ë²•:
    * ëŒ€ë¶€ë¶„ì˜ íŠ¹ì„± ìƒê´€ê´€ê³„ì˜ ì›ì¸ì„ íŠ¹ì •í•˜ê¸° ì–´ë ¤ì›€
    * ì € / ê³ ì°¨ì›ì˜ ìƒê´€ê´€ê³„ë¥¼ ëª¨ë‘ íš¨ìœ¨ì ìœ¼ë¡œ ì¶œë ¥

1. ì„ í˜• ëª¨ë¸ 
    * ê³ ì°¨ì›ì˜ ìƒê´€ê´€ê³„ ì¶”ì¶œì´ ì–´ë ¤ì›€ 
    * E.g. FM 

2. Deep neural network e.g. CNN, RNN 
    * CNN : biased to the interaction between neighboring features
    * RNN suitable for click dta with sequential dependency 
    * FNN & PNN : ì €ì°¨ì›ì˜ ìƒê´€ê´€ê³„ë¥¼ ì˜ ì°¾ì§€ ëª»í•¨

3. Hybrid network structure : linear model and deep model ì˜ í•©ì¹œ? ëª¨ë¸
    * Wide : linear, Deep : deep network model
    * ë‹¨ì  : ì „ë¬¸ì ì¸ feature engineering ì´ í•„ìš”í•¨


<br />

## 02 WHAT IS DEEP FM?

#### Deep FM : A factorization-Machine based Neural Network for CTR Prediction

###### Deep FM ì´ë€?:

* FM ê³¼  DNN ì„ í†µí•©ì‹œí‚¨ êµ¬ì¡° 
    * 2ì°¨ì› íŠ¹ì„± ìƒê´€ê´€ê³„ FM 
    * ê³ ì°¨ì› íŠ¹ì„± ìƒê´€ê´€ê³„ DNN
    * $\hat{ğ‘Œ} =ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘(ğ‘¦_{ğ¹ğ‘€}+ğ‘¦_{ğ·ğ‘ğ‘})$
    
    
* wide& Deep ëª¨ë¸ê³¼ì˜ ì°¨ì´ì  : feature engineering ì´ í•„ìš”ê°€ì—†ìŒ
* ë‘ê°œì˜ ì…ë ¥ì¸µì´ ì•„ë‹Œ, í•˜ë‚˜ì˜ ì…ë ¥ì¸µ, 
* ëª©í‘œ : ì €ì°¨ì›ê³¼ ê³ ì°¨ì›ì˜ ìƒê´€ê´€ê³„ í•™ìŠµ

###### ì…ë ¥ ë°ì´í„° X:

* ì‚¬ìš©ìì™€ ì•„ì´í…œì˜ Multifield data 
* ë²”ì£¼í˜•ë°ì´í„°(ì„±ë³„, ìœ„ì¹˜), ì—°ì†í˜• ë°ì´í„°(ë‚˜ì´) ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë³µí•©ë°ì´í„° 
    * ë²”ì£¼í˜• ë°ì´í„°ëŠ” one hot encoding ìœ¼ë¡œ ë³€í™˜
    * ì—°ì†í˜• ë°ì´í„°ëŠ” ê° ê°’ ë˜ëŠ” ë²”ì£¼í˜• ë°ì´í„°ë¡œ ë³€í˜• í›„ one hot encoding ìœ¼ë¡œ í‘œí˜„
* ìµœì¢… í˜•íƒœ : X = [xfield1, xfield2, xfield3, â€¦, xfieldm] 
* D â€“ ì°¨ì›ì˜ ë²¡í„° í˜•íƒœ ë°ì´í„° , ê³ ì°¨ì› + extremely sparse 

###### Structure : Embedding Layer

![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/struct1.png){: .align-center}

##### FM component
![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/struct2.png){: .align-center}

##### Deep component 
![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/struct3.png){: .align-center}

##### DeepFM model 
![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/struct4.png){: .align-center}

<br />

## 03 Contrast 

#### Contrast with existing models

![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/cont1.png){: .align-center}

##### íš¨ìœ¨ì„± ë¹„êµ
![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/cont2.png){: .align-center}

![Git repository ì‹ ê·œ ìƒì„± ì´ë¯¸ì§€]({{ site.url }}{{ site.baseurl }}/assets/images/deepfm/cont3.png){: .align-center}


